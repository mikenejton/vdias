{% extends "base.html" %}

{% block content %}
{% if result|length == 0 %}
    <p class="error_txt">Результаты не найдены</p>
{% else %}
<table>
    <thead>
        <tr>
            <th>#</th>
            <th>Объект</th>
            <th>Роль</th>
            <th>Заявка заполнена</th>
            <th>Статус</th>
            <th>Исполнитель</th>
            <th>Дата создания</th>
            <th>Автор</th>
        </tr>
    </thead>
    {% for item in result %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td><a class="link" href="{% url 'vitem' vitem_id=item.id %}">{% firstof item.person.person item.organization.organization 'Короткая заявка' %}</a></td>
            <!-- {% if item.person %}
            <td><a class="link" href="{% url 'vitem' vitem_id=item.id %}">{% firstof item.person.person item.organization.organization 'Короткая заявка' %}</a></td>
            {% elif item.organization %}
            <td><a class="link" href="{% url 'vitem' vitem_id=item.id %}">{{ item.organization.organization }}</a></td>
            {% elif item.short_item %}
            <td><a class="link" href="{% url 'vitem' vitem_id=item.id %}">Короткая заявка</a></td>
            {% endif %} -->
            <td>{% firstof item.organization.role item.person.role item.short_item.role %}</td>
            <td>{{ item.is_filled|yesno:"Да,Нет" }}</td>
            <td>{{ item.dias_status }}</td>
            <td>{{ item.case_officer.user.last_name }} {{ item.case_officer.user.first_name }}</td>
            <td>{{ item.created }}</td>
            <td>{{ item.author.user.last_name }} {{ item.author.user.first_name }}</td>
        </tr>
    {% endfor %}
</table>
{% endif %}
{% endblock %}